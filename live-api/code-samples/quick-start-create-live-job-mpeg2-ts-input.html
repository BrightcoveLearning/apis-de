---
title: 'Schnellstart: Erstellen Sie einen Live-Job für die MPEG2-TS-Eingabe'
description: 'Dieses Tutorial führt Sie durch das Erstellen eines Live-Jobs, der MPEG2-TS-Eingaben akzeptiert. Der Job wird mit der Live-API erstellt.'
parent: Code Samples 
grandparent: Live API
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">Überblick</h2>

<figure class="bcls-figure"><img alt="general-block-diagram" src="/assets/images/live-api/18727/block-diagram-small.png" />Blockschaltbild</figure>

<p>In diesem Tutorial wird auf API-Ebene erklärt, wie Sie einen Live-Streaming-Job in . erstellen <a href="/live-api/index.html">Brightcove live</a> die MPEG2-TS-Eingabe akzeptiert. Der Schlüssel zur Verwendung des MPEG2-TS-Eingangs besteht darin, a <code translate="No">protocol</code> die MPEG2-TS unterstützt und die Ihr Encoder liefern kann. Die von der Live-API unterstützten TS-fähigen Protokolle sind:</p>

<ul>
	<li><code translate="No">rtp</code></li>
	<li><code translate="No">rtp-fec</code></li>
	<li><code translate="No">srt</code></li>
</ul>

<p>Eines dieser Protokolle muss explizit angegeben werden, um die TS-Eingabe zu verwenden, da das Standardeingabeprotokoll ist <code translate="No">rtmp</code>.</p>

<p>Um SMPTE-Timecodes für Clipping, SSAI-Cue-Points oder ID3-Tags zu verwenden, sollten diese in das H.264 (AVC)-Video in SEI Picture Timing-Meldungen eingefügt werden.</p>

<p>Denken Sie daran, dass diese Protokolle UDP (User Datagram Protocol) anstelle von TCP für die Kommunikation zwischen dem Encoder und Live verwenden, daher muss Ihre Firewall / Ihr Router richtig konfiguriert sein und UDP-Ausgaben ins Internet von der IP des Encoders zulassen.</p>

<aside class="bcls-aside bcls-aside--information">Beachten Sie, dass Brightcove bei offenen Ports in einem lokalen Netzwerk Ports dynamisch für jeden SRT- und RTP-Auftrag zuweist, der zwischen 10000 und 65535 liegen kann.</aside>

<p>Wenn Sie verwenden <code translate="No">rtp-fec</code> , FEC-Informationen werden über einen anderen Port als das Medium gesendet. Wenn Sie also beispielsweise Port 2000 verwenden, müssen Sie auch die Ports 2002 und 2004 öffnen (wenn Sie 2D-FEC verwenden).</p>

<p>Dieses Tutorial verwendet <a translate="No" href="https://general.support.brightcove.com/developer/concepts-set-curl.html">Locken</a> um die API-Anfragen zu stellen, aber Sie können sie ganz einfach eingeben <a translate="No" href="https://apis.support.brightcove.com/general/use-insomnia-api-requests.html">Schlaflosigkeit</a> , <a translate="No" href="https://apis.support.brightcove.com/general/use-postman-api-requests.html">Postbote</a> oder andere REST-Clients stattdessen.</p>
</section>

<section class="bcls-section">
<h2 id="create_a_live_job">Erstellen Sie einen Live-Job</h2>

<p>Zuerst erstellen wir einen Live-Job. Sie benötigen eine <code translate="No">API-KEY</code> für die Live-API. Wenn Sie dies nicht tun und daran interessiert sind, Zugang zu erhalten, wenden Sie sich bitte an Ihren Account Manager.</p>

<ol class="bcls-tasklist-restart">
	<li>
	<p>Kopieren Sie Folgendes und fügen Sie es ein <span translate="No">Locken</span> Befehl in einen Texteditor:</p>

	<pre class="line-numbers">
  <code class="language-bash" translate="No">curl -X POST \
    https://api.bcovlive.io/v1/jobs \
    -H 'Content-Type: application/json' \
    -H 'x-api-key: <span class="bcls-input">{{bcov-live-api-key}}</span>' \
    -d '{
      "live_stream": true,
      "region": "<span class="bcls-input">{{closest_aws_region}}</span>",
      "protocol": "<span class="bcls-input">{{your_protocol}}</span>",
      "cidr_whitelist": ["<span class="bcls-input">{{your_encoder_IPrange}}</span>", "<span class="bcls-input">{{your_backup_encoder_IPrange}}</span>"],
      "outputs": [{
          "label": "hls360p",
          "live_stream": true,
          "height": 360,
          "video_bitrate": 365,
          "segment_seconds": 6,
          "keyframe_interval": 60
     },
     {
          "label": "hls432p",
          "live_stream": true,
          "height": 432,
          "video_bitrate": 730,
          "segment_seconds": 6,
          "keyframe_interval": 60
     },
     {
          "label": "hls540p",
          "live_stream": true,
          "height": 540,
          "video_bitrate": 2000,
          "segment_seconds": 6,
          "keyframe_interval": 60
     },
     {
          "label": "hls720p3M",
          "live_stream": true,
          "height": 540,
          "video_bitrate": 2000,
          "segment_seconds": 6,
          "keyframe_interval": 60
     },
     {
          "label": "hls720p4.5M",
          "live_stream": true,
          "height": 720,
          "video_bitrate": 4500,
          "segment_seconds": 6,
          "keyframe_interval": 60
     }]
  }'</code></pre>
	</li>
	<li>
	<p><strong>Nehmen Sie die folgenden Ersetzungen vor:</strong></p>

	<ul>
		<li><code translate="No">{{bcov-live-api-key}}</code> mit Ihrem Brightcove Live-API-Schlüssel. Zum Beispiel: <code translate="No">abcdfeg-this-is-a-fake-api-key-FgJajjasd12hJHsZ</code></li>
		<li><code translate="No">{{closest_aws_region}}</code> mit der nächstgelegenen verfügbaren Region zu Ihrem Encoder, siehe <a href="/live-api/getting-started/overview-brightcove-live-api.html#Support_aws_regions">nächstgelegene verfügbare Regionen</a> zu Ihrem Encoder. Zum Beispiel: <code translate="No">us-west-2</code></li>
		<li><code translate="No">{{your_protocol}}</code> mit dem Eingabeprotokoll liefert Ihr Encoder: <code translate="No">rpt</code> , <code translate="No">rtp-fec</code> , oder <code translate="No">srt</code></li>
		<li><code translate="No">{{your_encoder_IPrange}}</code> mit dem IP-Bereich, den Ihr Encoder verwenden wird, in Form von <code translate="No">1.2.3.4/32</code></li>
		<li><code translate="No">{{your_backup_encoder_IPrange}}</code>(falls vorhanden) mit dem IP-Bereich, den Ihr Backup-Encoder verwenden wird, in Form von <code translate="No">1.2.3.4/32</code></li>
	</ul>
	</li>
	<li>Nachdem Sie diese Änderungen vorgenommen haben, kopieren Sie den Code und fügen Sie ihn in das Terminal oder eine beliebige Befehlszeilen-App ein, die Sie verwenden, und führen Sie ihn aus.</li>
	<li>
	<p>Die Antwort sollte in etwa so aussehen, wenn Sie das verwenden <code translate="No">rtp-fec</code> Protokoll:</p>

	<pre class="line-numbers">
  <code class="language-json" translate="No">{
      "id": "42c913e5373844a99a6285367f2704ec",
      "outputs": [... removed for simplicity ...],
      "stream_url": "<span class="bcls-highlight">rtp:</span>//ec2-34-212-0-224.us-west-2.compute.amazonaws.com:12675",
      "stream_name": "42c913e5373844a99a6285367f2704ec.stream",
      "static": false,
      "encryption": {},
      "playback_url": "https://bcovlive-a.akamaihd.net/42c913e5373844a99a6285367f2704ec/us-west-2/NA/playlist.m3u8",
      "playback_url_dvr": "https://bcovlive-a.akamaihd.net/42c913e5373844a99a6285367f2704ec/us-west-2/NA/playlist_dvr.m3u8"
  }</code></pre>

	<p>Oder so für <code translate="No">srt</code>:</p>

	<pre class="line-numbers">
  <code class="language-json" translate="No">{
      "id": "cdb820f2d7764b91a79536dac799fb77",
      "outputs": [... removed for simplicity ...],
      "stream_url": "srt://ec2-34-212-0-224.us-west-2.compute.amazonaws.com:13820",
      "stream_name": "cdb820f2d7764b91a79536dac799fb77.stream",
      "static": false,
      "encryption": {},
      "playback_url": "https://bcovlive-a.akamaihd.net/cdb820f2d7764b91a79536dac799fb77/us-west-2/NA/playlist.m3u8",
      "playback_url_dvr": "https://bcovlive-a.akamaihd.net/cdb820f2d7764b91a79536dac799fb77/us-west-2/NA/playlist_dvr.m3u8"
  }</code></pre>
	</li>
</ol>

<aside class="bcls-aside bcls-aside--information">Beachten Sie, dass der Port (13820 im obigen Beispiel) für den SRT-Stream für jeden Job eindeutig ist und Sie ihn aus der Antwort der Joberstellungsanforderung abrufen müssen!</aside>

<p>Mit diesen Jobs werden 5 Wiedergabeversionen erstellt <strong>basierend</strong> An <a href="https://developer.apple.com/documentation/http_live_streaming/hls_authoring_specification_for_apple_devices">Apple-Empfehlungen</a>.</p>
</section>

<section class="bcls-section">
<h2 id="Configure_your_encoder_ts">Konfigurieren Sie Ihren Encoder (TS+FEC)</h2>

<p>Die hier gezeigten Schritte gehen davon aus, dass ein <a href="https://www.elemental.com/products/aws-elemental-live">Elementare Live-Box</a> Encoder, der beim Testen der Schritte für dieses Tutorial verwendet wurde. Wenn Sie einen anderen Encoder haben, sollten die Einstellungen ähnlich sein.</p>

<p>Die wichtigsten Einstellungen dafür <code translate="No">rtp-fec</code> Eingabe sind:</p>

<ul>
	<li>Konfigurieren Sie die Timecode-Quelle als "Systemuhr"</li>
	<li>Setzen Sie "Fehlerkorrektur weiterleiten" auf "Spalte und Zeile" und setzen Sie die Werte für "Spaltentiefe" und "Zeilenlänge":
	<ul>
		<li><strong>Säulentiefe:</strong> 4 (1 zusätzliches FEC-Paket wird jedem "Column Depth" TS-Paket hinzugefügt)</li>
		<li><strong>Zeilenlänge:</strong> 10 (1 zusätzliches FEC-Paket wird zu jedem TS-Paket mit "Reihenlänge" hinzugefügt)</li>
		<li>Zusätzliche hinzugefügte Daten können berechnet werden: TotalBitrate = MediaBitrate * (1/(Spaltentiefe + 1) + 1/(Zeilenlänge + 1)</li>
	</ul>
	</li>
	<li>Überprüfen Sie "Timecode-Einfügung" im Video</li>
	<li>Wärmstens empfohlen: Bildrate = Quelle folgen</li>
</ul>

<p>Dies ist die Konfiguration, die wir für dieses TS+FEC-Beispiel verwendet haben:</p>

<figure class="bcls-figure"><img alt="elemental-live-job-config" title="Elemental live config" src="/assets/images/live-api/18727/elemental-live-job-config-fec-v1a.png" />
<figcaption class="bcls-caption--image">Elementare Live-Konfiguration</figcaption>
</figure>
</section>

<section class="bcls-section">
<h2 id="Configure_your_encoder_srt">Konfigurieren Sie Ihren Encoder (SRT)</h2>

<p>Das hier gezeigte Setup basiert auf a <a href="https://www.haivision.com/products/kb-series/">Haivision KB</a> Encoder, der beim Testen der Schritte für dieses Tutorial verwendet wurde. Wenn Sie einen anderen Encoder haben, sollten die Einstellungen ähnlich sein.</p>

<p>Dies ist die Konfiguration, die wir für dieses SRT-Beispiel verwendet haben:</p>

<figure class="bcls-figure"><img alt="Haivision-live-job-config" title="Haivision live config" src="/assets/images/live-api/18727/haivision-kb-srt-config.png" />
<figcaption class="bcls-caption--image">Haivision Live-Konfiguration</figcaption>
</figure>
</section>

<section class="bcls-section">
<h2 id="test_playback">Wiedergabe testen</h2>

<p>Das kannst du benutzen <a href="https://videojs.github.io/videojs-contrib-hls/">VideoJS HLS-Demoseite</a> Um die Wiedergabe zu testen, fügen Sie einfach den Wert ein <code translate="No">playback_url</code> in der Antwort des Erstellungsjobs zurückgegeben:</p>

<figure class="bcls-figure"><img alt="videojs-hls-playback" title="VideoJS HLS playback demo page" src="/assets/images/live-api/18727/videojs-hls-playback-small.png" />
<figcaption class="bcls-caption--image">VideoJS HLS-Wiedergabe-Demoseite</figcaption>
</figure>
</section>
</article>