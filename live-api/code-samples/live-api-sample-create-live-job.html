---
title: 'Live-API-Beispiel: Erstellen Sie einen Live-Job'
parent: Code Samples 
grandparent: Live API
---

<article class="bcls-article">
  <h1>Live-API-Beispiel: Erstellen Sie einen Live-Job</h1>
  <summary>In diesem Beispiel erfahren Sie, wie Sie einen einfachen Live-Job erstellen.</summary>


<section class="bcls-section">
<h2 id="Introduction">Einführung</h2>

<p>In diesem Beispiel wird ein einfacher Live-Job mit drei Ausgabedarstellungen erstellt: 1080p, 720p und 480p.</p>

<p>Weil das <span translate="No">Live-API</span> nicht CORS-fähig ist und von einer serverseitigen App aus aufgerufen werden muss, wird die API-Anfrage über einen einfachen in PHP geschriebenen Proxy gesendet. Sie können dies in jeder serverseitigen Sprache reproduzieren – es werden lediglich die vom JavaScript gesendeten Anforderungsparameter erfasst, die Anforderung an die API gesendet und die Antwort an das JavaScript zurückgegeben. Alle Codes finden Sie in der <a href="#code">Codeabschnitt unten</a>.</p>
</section>

<section class="bcls-section">
<h2 id="create_live_job_app">Live-Job-App erstellen</h2>
Hier finden Sie den gesamten Code, der mit diesem Beispiel verknüpft ist <a href="https://github.com/BrightcoveLearning/18519-live-api-sample-create-live-job">GitHub-Repository</a>.

<p data-height="1400" data-theme-id="dark" data-slug-hash="ZoYoVY" data-default-tab="result" data-user="rcrooks1969" data-embed-version="2" data-pen-title="Live API Sample: Create a Live Job" class="codepen">Siehe den Stift <a href="https://codepen.io/team/rcrooks1969/pen/ZoYoVY/">Live-API-Beispiel: Erstellen Sie einen Live-Job</a> von Brightcove Learning Services (<a href="https://codepen.io/rcrooks1969">@rcroooks1969</a> ) An <a href="https://codepen.io">CodePen</a>.</p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script></section>

<section class="bcls-section">
<h2 id="Using_the_CodePen" class="bcls-expander-head">Verwenden des CodePens</h2>

<div class="bcls-expander-content">
<p>Hier sind einige Tipps, um den obigen CodePen effektiv zu verwenden:</p>

<ul>
	<li>Schalten Sie die aktuelle Anzeige des Players um, indem Sie auf klicken <strong>Ergebnis</strong> Taste.</li>
	<li>Drücke den <strong>HTML/CSS/JS</strong> Tasten, um EINEN der Codetypen anzuzeigen.</li>
	<li>Klicken <strong>Auf CodePen bearbeiten</strong> in der oberen rechten Ecke, um diesen CodePen Ihrem eigenen Konto zuzuordnen.</li>
	<li>Hier finden Sie den gesamten Code, der mit diesem Beispiel verknüpft ist <a href="https://github.com/BrightcoveLearning/18519-live-api-sample-create-live-job">GitHub-Repository</a>.</li>
</ul>
</div>
</section>

<section class="bcls-section">
<h2 id="code">Proxy-Code</h2>

<p>Zusätzlich zum Code in CodePen (und dem zugehörigen GitHub-Repository) erfordert dieses Beispiel einen Proxy, um die API-Anfrage zu stellen und die Antwort an die App zurückzugeben. Für diese App haben wir PHP verwendet, und der Code ist unten gezeigt. Sie können jede serverseitige Sprache verwenden, um den Proxy zu erstellen.</p>

<details>
	<summary>Proxy-Beispielcode</summary>
	<pre class="line-numbers">
	<code class="language-php">&lt;?php /** * live-proxy.php - Proxy für Brightcove Live-APIs * stellt die Anfrage und gibt die Antwort zurück * Zugriff: * (Beachten Sie, dass Sie *immer* über HTTPS auf den Proxy zugreifen sollten) * Methode: POST * * @post {string} url - die URL für die API-Anfrage * @post {string} [requestType=GET] - HTTP-Methode für die Anfrage * @post {string} [requestBody] - JSON-Daten, die mit Schreibanfragen gesendet werden sollen * @post {string} apiKey - Live-API-Schlüssel * * @returns {string} $response - Von der API empfangene JSON-Antwort */ // CORS-Aktivierung und andere Header header("Access-Control-Allow-Origin: *"); header("Inhaltstyp: Anwendung/json"); header("X-Content-Type-Optionen: nosniff"); header("X-XSS-Schutz"); $requestData = json_decode(file_get_contents('php://input')); // API-Aufruf einrichten // API-Schlüssel abrufen $apikey = $requestData-&gt;apiKey; // Anfragetyp abrufen oder standardmäßig GET verwenden if ($requestData-&gt;requestType) { $method = $requestData-&gt;requestType; } anders { $method = "GET"; } // weitere Sicherheitsüberprüfungen $needle = '.io'; $endapi = strpos($requestData-&gt;url, $nadel) + 3; $nextChar = substr($requestData-&gt;url, $endapi, 1); if (strpos($requestData-&gt;url, 'api.bcovlive.io') == false) { exit('{"ERROR":"Only requests to Brightcove Live APIs are accepted by this proxy"}'); } else if ($nextChar !== '/' &amp;&amp; $nextChar !== '?') { exit('{"ERROR": "There was a problem with your API request - please check the URL"}'); } // Holen Sie sich die URL und die Autorisierungsinformationen aus den Formulardaten $request = $requestData-&gt;url; //sende die http-Anfrage if ($requestData-&gt;requestBody) { $ch = curl_init($request); curl_setopt_array($ch, array( CURLOPT_CUSTOMREQUEST =&gt; $method, CURLOPT_RETURNTRANSFER =&gt; TRUE, CURLOPT_SSL_VERIFYPEER =&gt; FALSE, CURLOPT_HTTPHEADER =&gt; array( 'Content-type: application/json', "X-API-KEY: {$apikey}", ), CURLOPT_POSTFIELDS =&gt; $requestData-&gt;requestBody )); $response = curl_exec($ch); curl_close($ch); } else { $ch = curl_init($request); curl_setopt_array($ch, array( CURLOPT_CUSTOMREQUEST =&gt; $method, CURLOPT_RETURNTRANSFER =&gt; TRUE, CURLOPT_SSL_VERIFYPEER =&gt; FALSE, CURLOPT_HTTPHEADER =&gt; array( 'Content-type: application/json', "X-API-KEY: {$apikey}", ) )); $response = curl_exec($ch); curl_close($ch); } // Auf Fehler prüfen if ($response === FALSE) { $logEntry = "\nError:\n". "\n".date("Y-m-d H:i:s")." UTC \n" .$response; $logFileLocation = "log.txt"; $fileHandle = fopen($logFileLocation, 'a') or die("-1"); fwrite($fileHandle, $logEntry); fclose($fileHandle); echo '{"ERROR": "There was a problem with your API call"}'+ sterben(curl_error($ch)); } // Antwort entschlüsseln // $responseData = json_decode($response, TRUE); // die Antwort an den AJAX-Aufrufer zurückgeben $responseDecoded = json_decode($response); // if (!isset($responseDecoded)) { // $response = '{null}'; // } echo $antwort; ?&gt; </code></pre>
</details>
</section>

<script src="//learning-services-media.brightcove.com/doc-assets/node/18519-live-api-sample-create-live-job/create-job.js">

</script>

</article>